import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# 1. Simulate Netflix-like dataset
np.random.seed(42)
rows = 8500

data = {
    'type': np.random.choice(['Movie', 'TV Show'], size=rows, p=[0.7, 0.3]),
    'country': np.random.choice(['United States', 'India', 'United Kingdom', 'Canada', 'Japan'], size=rows, p=[0.5, 0.2, 0.1, 0.1, 0.1]),
    'date_added': pd.to_datetime(np.random.choice(pd.date_range('2010-01-01', '2021-12-31'), size=rows)),
    'listed_in': np.random.choice(['Drama', 'Comedy', 'Documentary', 'Action', 'Romance', 'Thriller', 'Family', 'Crime', 'Horror', 'Sci-Fi'], size=rows),
    'duration': np.where(
        np.random.choice(['Movie', 'TV Show'], size=rows, p=[0.7, 0.3]) == 'Movie',
        np.random.choice([f'{i} min' for i in range(60, 181)], size=rows),
        np.random.choice([f'{i} Season' if i == 1 else f'{i} Seasons' for i in range(1, 11)], size=rows)
    )
}

netflix = pd.DataFrame(data)
netflix['year_added'] = netflix['date_added'].dt.year

# 2. Basic Cleanup
key_columns = ['type', 'country', 'date_added', 'listed_in', 'duration']
netflix[key_columns] = netflix[key_columns].fillna('Unknown')

sns.set(style='whitegrid', palette='Set2')

# 3. Plot 1: Movies vs TV Shows
plt.figure(figsize=(6,4))
sns.countplot(x='type', data=netflix)
plt.title('Count of Movies vs TV Shows')
plt.xlabel('Content Type')
plt.ylabel('Count')
plt.show()

# 4. Plot 2: Top 5 Countries
plt.figure(figsize=(6,6))
top_countries = netflix['country'].value_counts().head(5)
plt.pie(top_countries, labels=top_countries.index, autopct='%1.1f%%', startangle=140, colors=sns.color_palette('pastel'))
plt.title('Top 5 Countries by Content Count')
plt.show()

# 5. Plot 3: Content Added Per Year
content_per_year = netflix['year_added'].value_counts().sort_index()
plt.figure(figsize=(8,5))
sns.lineplot(x=content_per_year.index, y=content_per_year.values, marker='o', color='blue')
plt.title('Content Released per Year on Netflix (Simulated)')
plt.xlabel('Year Added')
plt.ylabel('Number of Titles')
plt.show()

# 6. Plot 4: Top 10 Genres
top_genres = netflix['listed_in'].value_counts().head(10)
plt.figure(figsize=(8,5))
sns.barplot(x=top_genres.values, y=top_genres.index)
plt.title('Top 10 Genres on Netflix (Simulated)')
plt.xlabel('Number of Titles')
plt.ylabel('Genre')
plt.show()

# 7. Plot 5: Duration Distribution
movies = netflix[netflix['type'] == 'Movie'].copy()
tv_shows = netflix[netflix['type'] == 'TV Show'].copy()

movies['duration_int'] = movies['duration'].str.replace(' min', '', regex=True).astype(float)
tv_shows['duration_int'] = tv_shows['duration'].str.replace(' Season[s]?', '', regex=True).astype(float)

plt.figure(figsize=(8,5))
sns.kdeplot(data=movies, x='duration_int', fill=True, color='red', label='Movies')
sns.kdeplot(data=tv_shows, x='duration_int', fill=True, color='green', label='TV Shows')
plt.title('Distribution of Content Duration (Simulated)')
plt.xlabel('Duration (Minutes or Seasons)')
plt.ylabel('Density')
plt.legend()
plt.show()
